#include <iostream>
#include <cstdio>
#include <cstring>
using namespace std;

const int maxn = 105;
char str[maxn];
int dp[maxn][maxn];

bool ck(int i, int j) {
    if ((str[i] == '(' && str[j] == ')') || (str[i] == '[' && str[j] == ']')) {
        return true;
    } else {
        return false;
    }
}

int main() {
    while (~scanf("%s", str)) {
        if (str[0] == 'e') break;
        
        int len;
        len = strlen(str);
        memset(dp, 0, sizeof(dp));
        for (int l = 1; l < len; l++) {  //len =  j - i 为当前区间长度
            for (int i = 0, j = l; j < len; i++, j++) { // i++, j++
                if (ck(i, j)) { // 匹配
                    dp[i][j] = dp[i + 1][j - 1] + 1;
                }
                // 讨论区间合并情况，求最大值
                for (int pos = i; pos < j; pos++) {
                    dp[i][j] = max(dp[i][j], dp[i][pos] + dp[pos + 1][j]);
                }
            }
        }
        printf("%d\n", dp[0][len - 1]);
        
    }
    return 0;
}